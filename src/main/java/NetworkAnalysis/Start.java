package NetworkAnalysis;

import entites.Tweet;
import it.stilo.g.structures.WeightedDirectedGraph;
import org.apache.lucene.queryparser.classic.ParseException;

import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Set;

public class Start {
    public static void main(String[] args) throws IOException, ParseException {
        System.out.println("Starting...");
        System.out.println("Getting tweets...");
        //2.1
        FindTweets ft = new FindTweets();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
        //metodo per trovare, salvare e resituire tweet (creare dataset, eseguire una volta sola quando dataset Ã¨ vuoto)
        //ArrayList<Tweet> tweets= ft.find();

        //metodo per recuperare e restiutire tweet (dataset gia creato, eseguire piu volte dopo ft.find)
        ArrayList<Tweet> tweets= ft.getTweets();
////////////////////////////////////////////////////////////////////////////////////////////////////////////

        System.out.println("Done, nice");
        System.out.println("Let make some graph :D");

        System.out.println("Mentions Graph first...");

        //2.2b

        MentionsGraph  graph1 = new MentionsGraph();
        for (Tweet t : tweets) {
            long from = Long.parseLong(t.User_ID);
            if (graph1.adj.keySet().size() >= 10000) {      //limit first 10k users
                for (String mention : t.Mentions) {
                    long to = Long.parseLong(mention);
                    if (graph1.adj.keySet().contains(from) && graph1.adj.keySet().contains(to))
                        graph1.addEdge(from, to);
                }
            } else {
                for (String mention : t.Mentions) {
                    long to = Long.parseLong(mention);
                    graph1.addEdge(from, to);
                }
            }
        }
        // tagliare i bordi meno utili
            MentionsGraph graph = new MentionsGraph();
            for (long key : graph1.adj.keySet()) {
                if(!graph1.adj.get(key).isEmpty()) graph.adj.put(key,new ArrayList<>());
            }
            for (long key : graph.adj.keySet()){
                ArrayList<ArrayList<Long>> arcs = new ArrayList<>();
                for (ArrayList<Long> arc :graph1.adj.get(key)){

                    if (graph.adj.containsKey(arc.get(1))){
                        arcs.add(arc);
                    }
                }
                graph.addAllEdges(arcs);
            }

      /*
        graph1.addEdge(1, 2);
        graph1.addEdge(2, 3);
        graph1.addEdge(1, 3);
        graph1.addEdge(3, 1);
        graph1.addEdge(2, 1);
        graph1.addEdge(1, 3);
        graph1.addEdge(1, 2);
        graph1.addEdge(1,4);
        graph1.addEdge(6,5);
        graph1.addEdge(7,6);
        TimeGraph  graph2 = new TimeGraph();
        graph2.addEdge(1, 2);
        graph2.addEdge(2, 3);
        graph2.addEdge(1, 3);
        graph2.addEdge(3, 1);
        graph2.addEdge(2, 1);
        graph2.addEdge(1, 3);
        graph2.addEdge(4, 2);
        graph2.addEdge(4, 1);
        graph2.addEdge(3, 2);
        graph2.addEdge(4, 5);
        graph2.addEdge(3, 5);
*/

        System.out.println("Done!");
        //System.out.println( graph2);
        //ArrayList<Long> keys = (ArrayList<Long>) graph1.adj.keySet();
       // System.out.println(graph1.largestConnectedComponents());
        MentionsGraph graph3 = new MentionsGraph();
        System.out.println("Now largest Connected Component...");
        graph3.addAllEdges(graph.largestConnectedComponents());

        System.out.println( graph3);
        System.out.println(graph3.adj.size());

        Rank rank =new Rank();
        //System.out.println(rank.HITS(graph3.adj));
        //result of HITS for mention graph
        //{453473029=[453473029, 1107637753, 17559071], 3131529893=[3131529893, 9625016, 65927619], 1266142915073658882=[1266142915073658882, 92, 31], 2673243998=[2673243998, 75661690, 36980], 4906451067=[4906451067, 57554890, 34430554], 1247457342003843077=[1247457342003843077, 53824104, 2154283597], 851985789072408576=[851985789072408576, 460306306, 1], 755135678422327296=[755135678422327296, 665692584, 1131711], 702798054357909504=[702798054357909504, 43245164, 71418449], 450896622=[450896622, 49894, 356729], 91185505=[91185505, 113702947, 1], 843792645906464770=[843792645906464770, 35709224, 205978401], 19397942=[19397942, 5872804, 183142542], 22146373=[22146373, 7321161, 1452918], 18020612=[18020612, 520705250, 73957], 704282873231237121=[704282873231237121, 20486, 196303], 2834230515=[2834230515, 22847508, 4], 2582596082=[2582596082, 8630353, 365532], 1289171523744530438=[1289171523744530438, 23307172, 11202176], 883369310265249792=[883369310265249792, 47570633, 5], 7744592=[7744592, 19284, 1], 1962214610=[1962214610, 5237518, 221234], 711760467383877632=[711760467383877632, 4327808, 8], 465973=[465973, 1058762770, 1], 1113747629282930688=[1113747629282930688, 139451053, 71406], 52002602=[52002602, 411310255, 1], 3131144855=[3131144855, 5676125010, 36978], 87679233=[87679233, 26738506, 8], 3111266633=[3111266633, 7240802, 12958848], 2476130260=[2476130260, 15, 5], 98651557=[98651557, 304000082, 1], 730678734689316864=[730678734689316864, 827779, 13583286], 3380282686=[3380282686, 213245991, 1], 2770753891=[2770753891, 1858190276, 107943407], 21575948=[21575948, 3633052, 197227230], 18331985=[18331985, 382967044, 64084], 1060984350995550208=[1060984350995550208, 113758127, 1], 216647845=[216647845, 4799, 28801], 394581961=[394581961, 136124973, 18754480], 19088758=[19088758, 38970209, 55481], 873936250377523200=[873936250377523200, 9, 9], 44438256=[44438256, 107230, 392912], 2686834802=[2686834802, 30384325, 437262989], 14173315=[14173315, 2518, 6], 2452853334=[2452853334, 46803398, 207598090], 393343766=[393343766, 330726935, 196678474], 38460961=[38460961, 1470904, 93016570], 3220842388=[3220842388, 330185917, 383016858], 366629301=[366629301, 6, 5], 612473=[612473, 1604150206, 544275966], 79231168=[79231168, 452129641, 1536046], 15348883=[15348883, 701274541, 14574252], 46756531=[46756531, 54628393, 16027165], 15748239=[15748239, 20642112, 1452914], 405605548=[405605548, 77464534, 27088266], 886847235031519232=[886847235031519232, 9029942, 1], 135998621=[135998621, 24163833, 166186502], 555370896=[555370896, 509852723, 36028623], 20362684=[20362684, 5629155, 6], 81875055=[81875055, 64874680, 1], 302665348=[302665348, 234264853, 67973565], 2700131429=[2700131429, 658168599, 564232796], 534981494=[534981494, 470312, 2597680], 16664681=[16664681, 134413, 1], 742543573=[742543573, 27, 81], 77821953=[77821953, 77662027, 1], 796663225261682688=[796663225261682688, 483408788, 186754777], 117022298=[117022298, 143244997, 4], 14281853=[14281853, 600128836, 2137254], 297395484=[297395484, 82385082, 130214809], 15438913=[15438913, 628803717, 22717712], 37963496=[37963496, 3133160870, 273051719], 7587032=[7587032, 1287036153, 2196558], 1248268321251876866=[1248268321251876866, 375038953, 1013828299], 2170986966=[2170986966, 1689213126, 1153824866], 338460831=[338460831, 519957069, 36978], 2741488593=[2741488593, 2647812, 352155298], 16017475=[16017475, 117910518, 25], 26929440=[26929440, 2, 1], 241534687=[241534687, 40427998, 1], 807095=[807095, 121142767, 2], 2494186513=[2494186513, 28632504, 460013], 400953126=[400953126, 1306308330, 90430970], 222748037=[222748037, 112108191, 295828], 15157283=[15157283, 412307353, 3560498522], 331868929=[331868929, 47665535, 668285], 101447362=[101447362, 107866560, 1120371993], 24873392=[24873392, 53213039, 19011989], 49600056=[49600056, 290270221, 5], 1222591501=[1222591501, 401740966, 1], 1007698278337654784=[1007698278337654784, 31710884, 1155410603], 1113770602777673729=[1113770602777673729, 1299832, 488281455], 522634225=[522634225, 1663086586, 8966809], 191862712=[191862712, 25101454, 2195912], 231033118=[231033118, 437262989, 5285300743], 42590805=[42590805, 90503644, 1], 1327539789005017088=[1327539789005017088, 32465108, 1], 765344292390961152=[765344292390961152, 37369745, 1145832817], 19884529=[19884529, 17198682, 599628], 84035041=[84035041, 40531422, 34496385], 434525445=[434525445, 650659, 1870353], 289883555=[289883555, 20221770, 48172583], 231520553=[231520553, 31710884, 1298876], 107396736=[107396736, 1783331, 1], 2334732225=[2334732225, 374866430, 116215873], 97219875=[97219875, 33549541, 882549216], 69298376=[69298376, 6, 1], 1097501475239092224=[1097501475239092224, 460306305, 1201598085], 1347250338=[1347250338, 7299489, 1], 2383882980=[2383882980, 480911963, 4801], 28838219=[28838219, 583934, 392914], 21866939=[21866939, 4319614, 1535774], 337808606=[337808606, 1462067215, 8], 220626394=[220626394, 117345858, 53316363], 19227096=[19227096, 8758, 6265279], 41702018=[41702018, 1020381792, 411980090], 144658847=[144658847, 85628755, 35786428], 34713362=[34713362, 25906082, 1], 189868631=[189868631, 1470829, 1], 16970757=[16970757, 26072097, 16770165], 3092919645=[3092919645, 360457, 17198682], 105189186=[105189186, 1, 1], 216122857=[216122857, 6928048, 256002509], 381433782=[381433782, 23561704, 4274508], 1439661253=[1439661253, 148279164, 1], 1293113010941296640=[1293113010941296640, 182, 1], 45010849=[45010849, 518707103, 1], 62576309=[62576309, 827077973, 1647439130], 1647291168=[1647291168, 32413007, 12618909], 833150310524809216=[833150310524809216, 64098426, 14332683], 992149270399725568=[992149270399725568, 354107, 1], 1213104217675616256=[1213104217675616256, 1225633055, 34433059], 1174254240337977345=[1174254240337977345, 1220652440, 2], 1239187692=[1239187692, 8677, 1], 465870580=[465870580, 31060, 109438513], 12794362=[12794362, 8, 1], 80024060=[80024060, 33307416, 2478], 568143078=[568143078, 87786358, 63], 1290722208910839809=[1290722208910839809, 59423344, 545656675], 932242398855475200=[932242398855475200, 460306305, 50147], 489377813=[489377813, 374952778, 2917107], 149116322=[149116322, 54398, 54], 136004952=[136004952, 1645097353, 1], 2755983617=[2755983617, 1292690, 92700201], 207667494=[207667494, 74321057, 8783648], 62123765=[62123765, 641338561, 564030570], 147991962=[147991962, 127790560, 544275967], 1020242843879788544=[1020242843879788544, 16965056, 712419], 300205226=[300205226, 297, 81], 583001068=[583001068, 135698990, 1452918], 14569869=[14569869, 110296020, 1], 823255657902129153=[823255657902129153, 460306306, 1], 20675681=[20675681, 142764373, 71529470], 849590740246290433=[849590740246290433, 24577251, 1], 2666016692=[2666016692, 38852317, 712418], 953745799=[953745799, 7299489, 19796363], 1080173484771328004=[1080173484771328004, 1, 1883040575], 16949344=[16949344, 127706781, 1], 22812734=[22812734, 77626416, 25552138], 60606206=[60606206, 580767, 5834210], 2471529011=[2471529011, 31710884, 4099894940], 3362016513=[3362016513, 1413264593, 1], 19477583=[19477583, 39785411, 2955697], 23949317=[23949317, 2, 1], 2849876151=[2849876151, 374905947, 1937304], 371726146=[371726146, 7892199, 37982989], 51241574=[51241574, 14, 1], 2596143056=[2596143056, 13002807354, 76061136335], 40354568=[40354568, 248317194, 112655741], 363109588=[363109588, 917571, 1], 812295444604866560=[812295444604866560, 30796088, 2215314361], 645503=[645503, 619687962, 7120997044], 1046745148703608832=[1046745148703608832, 37101960, 2195912], 41874178=[41874178, 126401004, 82428199], 46148540=[46148540, 529875343, 216303764], 1351904422046167040=[1351904422046167040, 564506, 35709224], 146513211=[146513211, 24634057, 1], 19424427=[19424427, 179115577, 186098237], 750073625915559936=[750073625915559936, 200180, 52066], 19825835=[19825835, 2421860631, 44258240], 1169110058=[1169110058, 471776844, 7173269552], 233180256=[233180256, 11678686, 366650093], 564511791=[564511791, 2057814, 1029009], 1214974944066637825=[1214974944066637825, 18608245, 22717721], 51252892=[51252892, 2647812, 92700202], 53963427=[53963427, 40799849, 8840812], 538078599=[538078599, 315173984, 1], 14224719=[14224719, 1074890247, 40708842], 14157134=[14157134, 490291025, 1], 159541269=[159541269, 23553059, 1], 368240745=[368240745, 640474728, 44258240], 19740854=[19740854, 26072169, 162], 429958203=[429958203, 32465108, 824679798], 252794509=[252794509, 554060, 2357490], 25264158=[25264158, 374867770, 57994], 32493647=[32493647, 4002279, 1], 19608718=[19608718, 120550182, 185339100], 2623031806=[2623031806, 31710884, 90467948], 130133607=[130133607, 131827462, 22], 2212479606=[2212479606, 17559068, 363995025], 357627129=[357627129, 9678837, 1], 108882900=[108882900, 3946, 12618909], 1058288282503647232=[1058288282503647232, 98339237, 290426309], 2827787582=[2827787582, 2070675, 3], 2890801661=[2890801661, 376422775, 46], 2425571623=[2425571623, 800172489, 1], 748453510048518145=[748453510048518145, 39053548, 183142540], 254060179=[254060179, 1, 1], 801997428=[801997428, 72, 519], 971315817358020608=[971315817358020608, 13583286, 4922205], 96092282=[96092282, 6209520, 26300083], 21214339=[21214339, 625418, 1286052], 2838333676=[2838333676, 3260236994, 2298312088], 916305113630814213=[916305113630814213, 485255, 33389447], 18949349=[18949349, 56083723, 1], 2590932906=[2590932906, 874525979, 1], 36327407=[36327407, 52144194, 76061173315], 50689731=[50689731, 352607903, 1], 793377481982181376=[793377481982181376, 1118412994, 186338674], 15484198=[15484198, 199155720, 2137254], 604472778=[604472778, 26072097, 604522721], 3419251203=[3419251203, 107239, 1], 403510748=[403510748, 56327870, 39567380], 255223525=[255223525, 195562149, 7411603911], 2433924289=[2433924289, 330185917, 1], 351784239=[351784239, 23553060, 1], 754716839448633344=[754716839448633344, 51511127, 2597680], 1106193729235402753=[1106193729235402753, 147302017, 1], 1121799138239111168=[1121799138239111168, 40311190, 733300186], 2918267949=[2918267949, 505953745, 2513897037], 2423370157=[2423370157, 3200880, 1], 187561714=[187561714, 129163, 588534209], 152656121=[152656121, 90410325, 1], 224657541=[224657541, 123661076, 2993659095], 111556423=[111556423, 264709009, 45435424], 824761019591450625=[824761019591450625, 156094, 1], 1172862188001878016=[1172862188001878016, 134412, 1163422], 156287157=[156287157, 18658334, 1], 65375759=[65375759, 19270, 412184], 970810775064449024=[970810775064449024, 113702947, 71529472], 3000273701=[3000273701, 20486, 739691], 61183568=[61183568, 121551677, 1], 29744178=[29744178, 9, 6], 278267245=[278267245, 17106429, 57217179], 77732185=[77732185, 8856890002, 1], 517738272=[517738272, 37787, 35709224], 459362975=[459362975, 4319614, 1], 1207634475254865921=[1207634475254865921, 4453874047, 2211744861], 2842903409=[2842903409, 35400772, 31630024], 757537572=[757537572, 36454702, 10064719], 125143408=[125143408, 52751015, 451811704], 20973388=[20973388, 948527047, 15323], 812361923304034304=[812361923304034304, 67206, 1], 45586617=[45586617, 4002328, 25], 1478483473=[1478483473, 1, 1], 924993637355806720=[924993637355806720, 9029422, 15736322], 540113442=[540113442, 48075, 1], 249721079=[249721079, 46846006, 2022777721], 157981564=[157981564, 35330124, 1], 936231122895294465=[936231122895294465, 67089386, 124284953], 26985345=[26985345, 25552658, 15324], 326184301=[326184301, 39942351, 1], 551426814=[551426814, 1982723238, 2256886556], 561014615=[561014615, 5834215, 1], 430620548=[430620548, 135012732, 72358474], 733368807612395520=[733368807612395520, 95657456, 46], 405769757=[405769757, 24319207, 90430976], 914281548=[914281548, 28632504, 33389447], 2785680441=[2785680441, 494236417, 2305417096], 67584573=[67584573, 564408, 2104048965], 111411358=[111411358, 6, 1], 32372694=[32372694, 253226840, 790200081], 151655222=[151655222, 36350684, 760532], 14291684=[14291684, 665269515, 2], 596696494=[596696494, 113702947, 564033650], 1425679045=[1425679045, 87433304, 2286726302], 110437588=[110437588, 57023319, 44258240], 80872081=[80872081, 41935156, 6213390000], 16003760=[16003760, 2083145, 1], 117088433=[117088433, 16965056, 1], 1463193979=[1463193979, 13712, 1], 1146329871418843136=[1146329871418843136, 463595608, 1], 146569971=[146569971, 31502298, 1], 1288096167545450496=[1288096167545450496, 4922205, 276174801], 234694571=[234694571, 78035092, 183142542], 18063173=[18063173, 16605471, 332373004], 145671928=[145671928, 11774, 35118136], 299071371=[299071371, 894409, 2973998691], 380926184=[380926184, 686181058, 73666724], 352946007=[352946007, 39236143, 819155159], 1244892413262311425=[1244892413262311425, 3541203194, 384729171399], 2969760609=[2969760609, 942489, 90430976], 1031950356169809920=[1031950356169809920, 725317, 36028623], 2231199386=[2231199386, 465045937, 7868161], 12588712=[12588712, 32145238, 1], 152650610=[152650610, 9328675, 487584722], 16683666=[16683666, 244002458, 1], 2194905277=[2194905277, 118932460, 37982989], 855082102093754368=[855082102093754368, 61866612, 564045894], 46477493=[46477493, 491260, 3221442], 3029701349=[3029701349, 32413007, 7541970], 330993102=[330993102, 187533636, 6898836147], 14704278=[14704278, 375397791, 3109695], 1110536190548168704=[1110536190548168704, 23102483, 54073127], 88059720=[88059720, 12, 4], 34236531=[34236531, 501848609, 13417409], 1582533673=[1582533673, 16, 16], 4764882552=[4764882552, 253422456, 1065728734], 400181671=[400181671, 558464, 2058018], 3602010316=[3602010316, 120287613, 1298840], 1017702424553906176=[1017702424553906176, 1184669, 1735429548], 20543416=[20543416, 73477363, 1844003062], 245789728=[245789728, 96085, 276174801], 1059555794188939275=[1059555794188939275, 429047084, 11747291107], 81364561=[81364561, 12015942, 1091445768], 96386869=[96386869, 498516810, 186338674], 395642139=[395642139, 35480201, 2195912], 555337622=[555337622, 270783222, 7613107923], 382937180=[382937180, 6856, 512615], 1350891294927810560=[1350891294927810560, 2321428, 2321430], 20070307=[20070307, 51596046, 318268224], 2365875094=[2365875094, 33312899, 42821347], 18934707=[18934707, 7868161, 1], 1480749782=[1480749782, 459805520, 32791], 951599648=[951599648, 330185917, 7868161], 928250778002841602=[928250778002841602, 31710884, 2993696121], 453124512=[453124512, 2945219, 25], 1235849797191401472=[1235849797191401472, 34961284, 1], 1217786733540118528=[1217786733540118528, 17863120, 1], 28076811=[28076811, 19506629, 90430977], 223742975=[223742975, 10451636, 405630461], 1459872168=[1459872168, 224157594, 513730085], 1108477440517656576=[1108477440517656576, 7299489, 46212911], 3007452653=[3007452653, 24577248, 450070770], 173449447=[173449447, 23553059, 11309847], 863849562695487489=[863849562695487489, 660049084, 1], 3383159573=[3383159573, 75939543, 78754625], 1321997786817114112=[1321997786817114112, 19506629, 3255249073], 93026102=[93026102, 16897600, 11], 260632904=[260632904, 401865429, 34433059], 140955302=[140955302, 17787710, 1091378932], 171876607=[171876607, 394885684, 94], 194192721=[194192721, 103284, 184632439], 773798108=[773798108, 358491187, 5526513018], 90676132=[90676132, 86348, 2196558], 45840503=[45840503, 26072097, 183142541], 40156330=[40156330, 218084, 7], 1344341743664324608=[1344341743664324608, 234051417, 1], 273994373=[273994373, 62759, 1], 19058678=[19058678, 143515036, 199169707], 610659001=[610659001, 327635306, 593566], 873290594583547904=[873290594583547904, 26072097, 20436424832], 19017675=[19017675, 234148154, 1], 69732035=[69732035, 32687414, 1608133847], 179931221=[179931221, 1184669, 156093], 217015808=[217015808, 55481, 2653161], 773543378432786432=[773543378432786432, 384842, 5834211], 158021529=[158021529, 881651044, 923351412], 742143=[742143, 171775798, 1088551932], 2938261973=[2938261973, 234051417, 22717713], 44849238=[44849238, 54883872, 2011262], 317223956=[317223956, 42053918, 712110343], 5120691=[5120691, 2, 1], 211864158=[211864158, 119163347, 102196135], 20699709=[20699709, 382935984, 16], 26719898=[26719898, 104508, 544275966], 1214108358292041728=[1214108358292041728, 288840367, 90430972], 16973333=[16973333, 37582893, 1], 14085070=[14085070, 1452912, 14], 1010384732759252997=[1010384732759252997, 374866431, 1], 857193486=[857193486, 83726552, 582880715], 3402534359=[3402534359, 26072097, 1165798649], 17442320=[17442320, 900518, 30933306], 50425887=[50425887, 460306305, 162509497], 4842372993=[4842372993, 374866430, 202154531], 488896002=[488896002, 46265783, 2653161], 2932558313=[2932558313, 32, 32], 1652541=[1652541, 119563983, 7], 141141836=[141141836, 7299489, 1793292284], 56488059=[56488059, 124010735, 1], 459390022=[459390022, 1210848288, 563252733], 36667656=[36667656, 40858, 1], 14499829=[14499829, 252400235, 6], 1111014811343695872=[1111014811343695872, 3271662, 1286393767], 18831926=[18831926, 155253459, 2016183], 200161501=[200161501, 62758, 2321430], 86626845=[86626845, 131261, 1], 14085096=[14085096, 151196275, 183142546], 3929075062=[3929075062, 119667866, 623030593], 8170292=[8170292, 74474755, 1], 1726823845=[1726823845, 223752273, 233649028], 17393219=[17393219, 32791, 196303], 742321348664557568=[742321348664557568, 27625980, 5113665], 23456307=[23456307, 2917112, 1], 302938456=[302938456, 374866430, 25552660], 335312037=[335312037, 120255288, 1844018386], 85400142=[85400142, 1184564265, 22533636955], 743893144618565632=[743893144618565632, 4002278, 356729], 498986721=[498986721, 118028354, 2], 298734224=[298734224, 14277487, 4799], 16343974=[16343974, 1046114019, 1], 1058805479168712705=[1058805479168712705, 173555451, 1], 34655603=[34655603, 3833596, 366285080], 1264159600858857472=[1264159600858857472, 1124748, 1], 207739658=[207739658, 40858122, 747173116], 130034862=[130034862, 4319621, 1], 1310156987863310336=[1310156987863310336, 36492474, 1], 29056724=[29056724, 101241299, 16242753226], 815235053626093570=[815235053626093570, 452129641, 2215314425], 23424533=[23424533, 95512, 183142540], 219407970=[219407970, 1271140, 81343728], 119356526=[119356526, 241712681, 447702764], 1731805261=[1731805261, 156093, 3087027], 1255393579507351554=[1255393579507351554, 196303, 11687692], 1138528237615820801=[1138528237615820801, 637385, 109755312], 15179672=[15179672, 4327808, 412140995], 2412739760=[2412739760, 5105263, 1], 1281665097035898880=[1281665097035898880, 3633052, 837771122], 384772458=[384772458, 17198682, 90690714], 852538501832769540=[852538501832769540, 92254534, 1], 149522272=[149522272, 668178, 1], 121127090=[121127090, 2892658540, 11550752274], 28084774=[28084774, 8573712, 93016570], 3218868310=[3218868310, 12327, 44258240], 8973062=[8973062, 22806, 38399], 41822696=[41822696, 227927427, 5879031708], 513603850=[513603850, 53824104, 564030571], 883360024021659648=[883360024021659648, 28050782, 14760186763], 920692088=[920692088, 2730200, 18754480], 221370027=[221370027, 26673540, 585409398], 174263807=[174263807, 42513104, 40671864], 711945679=[711945679, 374866433, 1], 123933889=[123933889, 1452912, 1], 23169735=[23169735, 134414, 1], 2461075736=[2461075736, 1184670, 1], 868112495713685504=[868112495713685504, 1821760006, 24214319940], 2424097747=[2424097747, 6549904, 1498649746], 115494227=[115494227, 541796876, 819155347], 595530958=[595530958, 18408200, 1127283315], 3290364847=[3290364847, 17870, 1964568], 3391985055=[3391985055, 413025692, 521], 1281282260214386689=[1281282260214386689, 2070672, 73960], 34262462=[34262462, 23645718, 14], 10215212=[10215212, 945938493, 2570610139], 15798091=[15798091, 27332895, 1355483568], 41676231=[41676231, 152942205, 593566], 15687507=[15687507, 15420157, 2267607552], 300186148=[300186148, 506728, 102196135], 292015782=[292015782, 1, 1], 39416218=[39416218, 801987, 412187], 1071430976537018368=[1071430976537018368, 1145, 668285], 394087611=[394087611, 25682, 11739765], 1345456376601071617=[1345456376601071617, 512015, 1933599414], 38349184=[38349184, 1028909, 1], 2379915792=[2379915792, 1340, 32811], 1321001688279486464=[1321001688279486464, 72103245, 28524166649], 769634997682655236=[769634997682655236, 510626666, 527], 3314652765=[3314652765, 41417933, 709435993], 310746442=[310746442, 29383948, 1], 728039605=[728039605, 911641821, 699828324], 1070620981595639808=[1070620981595639808, 8265340, 585409398], 801412118=[801412118, 15994621, 1048358437], 621533=[621533, 233403219, 6531311594], 419757788=[419757788, 386176277, 23644404224], 1271001810153746433=[1271001810153746433, 119536169, 1455419325], 25067168=[25067168, 4922205, 5], 734703626099232768=[734703626099232768, 608681317, 416506937], 38142380=[38142380, 115277856, 11550752274], 19019465=[19019465, 120287613, 935994], 2836421=[2836421, 119536174, 6], 3922371135=[3922371135, 24577248, 29064876640], 1173511684142579713=[1173511684142579713, 585163481, 18321411947], 3364000629=[3364000629, 23433926, 1187133], 329607261=[329607261, 27, 243], 1104175997333708800=[1104175997333708800, 218073689, 3223216203], 533578801=[533578801, 535238, 713458], 52065508=[52065508, 53824104, 2286726303]}

        //System.out.println(rank.KP_NEG(graph3.adj));    //ci mette tantissimo tempo +20min per 511utenti, per 327(archi tagliati prima) 3min
        // result of KP_NEG for mentiongraph
        //{453473029=685, 3131529893=685, 1266142915073658882=311, 2673243998=685, 4906451067=685, 1247457342003843077=403, 851985789072408576=308, 755135678422327296=685, 702798054357909504=685, 450896622=685, 91185505=309, 843792645906464770=685, 19397942=685, 22146373=685, 18020612=685, 704282873231237121=386, 2834230515=310, 2582596082=685, 1289171523744530438=685, 883369310265249792=312, 7744592=313, 1962214610=685, 711760467383877632=312, 465973=309, 1113747629282930688=685, 52002602=308, 3131144855=685, 87679233=314, 3111266633=685, 2476130260=313, 98651557=321, 730678734689316864=685, 3380282686=311, 2770753891=685, 21575948=685, 18331985=685, 1060984350995550208=308, 216647845=317, 394581961=685, 19088758=685, 873936250377523200=311, 44438256=685, 2686834802=318, 14173315=318, 2452853334=387, 393343766=685, 38460961=685, 3220842388=385, 366629301=318, 612473=328, 79231168=685, 15348883=685, 46756531=685, 15748239=685, 405605548=685, 886847235031519232=308, 135998621=402, 555370896=685, 20362684=13, 81875055=308, 302665348=685, 2700131429=685, 534981494=685, 16664681=308, 742543573=11, 77821953=308, 796663225261682688=685, 117022298=314, 14281853=685, 297395484=685, 15438913=312, 37963496=685, 7587032=685, 1248268321251876866=685, 2170986966=685, 338460831=685, 2741488593=402, 16017475=311, 26929440=311, 241534687=308, 807095=311, 2494186513=389, 400953126=685, 222748037=389, 15157283=685, 331868929=685, 101447362=685, 24873392=685, 49600056=311, 1222591501=9, 1007698278337654784=383, 1113770602777673729=685, 522634225=685, 191862712=685, 231033118=318, 42590805=321, 1327539789005017088=308, 765344292390961152=685, 19884529=389, 84035041=685, 434525445=390, 289883555=383, 231520553=386, 107396736=309, 2334732225=387, 97219875=685, 69298376=309, 1097501475239092224=685, 1347250338=6, 2383882980=316, 28838219=685, 21866939=685, 337808606=314, 220626394=385, 19227096=389, 41702018=685, 144658847=685, 34713362=309, 189868631=322, 16970757=383, 3092919645=390, 105189186=309, 216122857=685, 381433782=685, 1439661253=310, 1293113010941296640=309, 45010849=9, 62576309=685, 1647291168=685, 833150310524809216=685, 992149270399725568=9, 1213104217675616256=685, 1174254240337977345=310, 1239187692=309, 465870580=390, 12794362=313, 80024060=685, 568143078=311, 1290722208910839809=685, 932242398855475200=685, 489377813=390, 149116322=7, 136004952=313, 2755983617=390, 207667494=685, 62123765=685, 147991962=322, 1020242843879788544=685, 300205226=11, 583001068=685, 14569869=11, 823255657902129153=308, 20675681=685, 849590740246290433=308, 2666016692=685, 953745799=390, 1080173484771328004=477, 16949344=308, 22812734=322, 60606206=388, 2471529011=406, 3362016513=308, 19477583=685, 23949317=309, 2849876151=685, 371726146=685, 51241574=309, 2596143056=318, 40354568=685, 363109588=309, 812295444604866560=685, 645503=685, 1046745148703608832=685, 41874178=685, 46148540=685, 1351904422046167040=685, 146513211=308, 19424427=685, 750073625915559936=685, 19825835=685, 1169110058=685, 233180256=386, 564511791=685, 1214974944066637825=17, 51252892=391, 53963427=391, 538078599=308, 14224719=685, 14157134=309, 159541269=4, 368240745=685, 19740854=9, 429958203=685, 252794509=685, 25264158=388, 32493647=308, 19608718=685, 2623031806=381, 130133607=313, 2212479606=685, 357627129=6, 108882900=685, 1058288282503647232=685, 2827787582=314, 2890801661=324, 2425571623=313, 748453510048518145=685, 254060179=325, 801997428=685, 971315817358020608=685, 96092282=685, 21214339=685, 2838333676=685, 916305113630814213=390, 18949349=308, 2590932906=313, 36327407=383, 50689731=325, 793377481982181376=685, 15484198=685, 604472778=385, 3419251203=308, 403510748=685, 255223525=385, 2433924289=6, 351784239=4, 754716839448633344=685, 1106193729235402753=308, 1121799138239111168=386, 2918267949=685, 2423370157=309, 187561714=685, 152656121=15, 224657541=384, 111556423=312, 824761019591450625=308, 1172862188001878016=685, 156287157=5, 65375759=685, 970810775064449024=685, 3000273701=386, 61183568=312, 29744178=311, 278267245=685, 77732185=314, 517738272=685, 459362975=308, 1207634475254865921=318, 2842903409=685, 757537572=685, 125143408=442, 20973388=685, 812361923304034304=308, 45586617=312, 1478483473=13, 924993637355806720=685, 540113442=308, 249721079=685, 157981564=324, 936231122895294465=685, 26985345=685, 326184301=9, 551426814=685, 561014615=308, 430620548=685, 733368807612395520=313, 405769757=685, 914281548=390, 2785680441=685, 67584573=685, 111411358=13, 32372694=685, 151655222=685, 14291684=309, 596696494=685, 1425679045=685, 110437588=685, 80872081=685, 16003760=308, 117088433=309, 1463193979=308, 1146329871418843136=325, 146569971=311, 1288096167545450496=685, 234694571=685, 18063173=401, 145671928=389, 299071371=385, 380926184=685, 352946007=685, 1244892413262311425=318, 2969760609=685, 1031950356169809920=383, 2231199386=685, 12588712=11, 152650610=685, 16683666=310, 2194905277=685, 855082102093754368=685, 46477493=685, 3029701349=322, 330993102=685, 14704278=685, 1110536190548168704=685, 88059720=314, 34236531=685, 1582533673=311, 4764882552=685, 400181671=685, 3602010316=385, 1017702424553906176=685, 20543416=322, 245789728=685, 1059555794188939275=685, 81364561=685, 96386869=685, 395642139=685, 555337622=446, 382937180=685, 1350891294927810560=685, 20070307=391, 2365875094=685, 18934707=308, 1480749782=685, 951599648=384, 928250778002841602=382, 453124512=311, 1235849797191401472=308, 1217786733540118528=308, 28076811=685, 223742975=685, 1459872168=685, 1108477440517656576=394, 3007452653=685, 173449447=413, 863849562695487489=309, 3383159573=685, 1321997786817114112=685, 93026102=311, 260632904=685, 140955302=389, 171876607=324, 194192721=387, 773798108=685, 90676132=387, 45840503=383, 40156330=318, 1344341743664324608=308, 273994373=308, 19058678=685, 610659001=685, 873290594583547904=387, 19017675=308, 69732035=685, 179931221=685, 217015808=685, 773543378432786432=685, 158021529=685, 742143=328, 2938261973=311, 44849238=685, 317223956=685, 5120691=310, 211864158=685, 20699709=310, 26719898=322, 1214108358292041728=685, 16973333=308, 14085070=320, 1010384732759252997=8, 857193486=685, 3402534359=384, 17442320=685, 50425887=685, 4842372993=387, 488896002=685, 2932558313=311, 1652541=315, 141141836=399, 56488059=337, 459390022=685, 36667656=309, 14499829=322, 1111014811343695872=685, 18831926=685, 200161501=685, 86626845=316, 14085096=685, 3929075062=391, 8170292=308, 1726823845=685, 17393219=685, 742321348664557568=388, 23456307=308, 302938456=388, 335312037=685, 85400142=685, 743893144618565632=685, 498986721=310, 298734224=317, 16343974=308, 1058805479168712705=309, 34655603=685, 1264159600858857472=308, 207739658=685, 130034862=310, 1310156987863310336=308, 29056724=685, 815235053626093570=685, 23424533=388, 219407970=685, 119356526=685, 1731805261=685, 1255393579507351554=685, 1138528237615820801=685, 15179672=685, 2412739760=308, 1281665097035898880=685, 384772458=388, 852538501832769540=308, 149522272=11, 121127090=685, 28084774=685, 3218868310=685, 8973062=317, 41822696=685, 513603850=382, 883360024021659648=685, 920692088=685, 221370027=685, 174263807=685, 711945679=8, 123933889=308, 23169735=308, 2461075736=308, 868112495713685504=685, 2424097747=685, 115494227=685, 595530958=685, 3290364847=685, 3391985055=685, 1281282260214386689=685, 34262462=310, 10215212=685, 15798091=685, 41676231=685, 15687507=328, 300186148=685, 292015782=6, 39416218=685, 1071430976537018368=685, 394087611=685, 1345456376601071617=685, 38349184=308, 2379915792=388, 1321001688279486464=685, 769634997682655236=685, 3314652765=414, 310746442=7, 728039605=685, 1070620981595639808=685, 801412118=391, 621533=328, 419757788=397, 1271001810153746433=446, 25067168=312, 734703626099232768=685, 38142380=685, 19019465=387, 2836421=318, 3922371135=685, 1173511684142579713=685, 3364000629=685, 329607261=11, 1104175997333708800=685, 533578801=685, 52065508=382}


        //System.out.println(rank.LPA(graph3.adj));
        /*
        {0=[1247457342003843077, 3220842388, 1007698278337654784, 289883555, 231520553, 220626394, 1080173484771328004, 2471529011, 36327407, 604472778, 255223525, 2433924289, 224657541, 299071371, 951599648, 928250778002841602, 45840503, 873290594583547904, 3402534359, 513603850, 52065508], 1=[34236531, 357627129, 17442320, 107396736, 5120691, 32493647, 2423370157, 34262462, 37963496, 111411358, 555370896, 330993102, 773798108, 15438913, 403510748, 384772458, 750073625915559936, 595530958, 459362975, 366629301, 156287157, 147991962, 711945679, 254060179, 2969760609, 61183568, 971315817358020608, 1046745148703608832, 2623031806, 252794509, 14157134, 2334732225, 16970757, 249721079, 1108477440517656576, 117088433, 8170292, 3000273701, 338460831, 45586617, 310746442, 77732185, 8973062, 149116322, 796663225261682688, 1266142915073658882, 44438256, 12588712, 174263807, 231033118, 1138528237615820801, 50425887, 1726823845, 121127090, 241534687, 3922371135, 395642139, 555337622, 42590805, 292015782, 1345456376601071617, 69298376, 105189186, 1293113010941296640, 51241574, 130034862, 21866939, 1060984350995550208, 1478483473, 19608718, 38142380, 430620548, 111556423, 219407970, 21214339, 39416218, 40156330, 93026102, 34713362, 245789728, 28838219, 3419251203, 234694571, 645503, 15348883, 191862712, 1327539789005017088, 19424427, 429958203, 19019465, 152656121, 45010849, 742321348664557568, 216647845, 19740854, 86626845, 3290364847, 2596143056, 2686834802, 2673243998, 2890801661, 1281282260214386689, 2827787582, 15484198, 337808606, 87679233, 711760467383877632, 15179672, 380926184, 3362016513, 79231168, 815235053626093570, 2918267949, 522634225, 2836421, 1271001810153746433, 335312037, 18831926, 807095, 14085096, 855082102093754368, 19397942, 2461075736, 1017702424553906176, 179931221, 65375759, 7744592, 873936250377523200, 1288096167545450496, 207667494, 489377813, 90676132, 2590932906, 538078599, 88059720, 110437588, 812295444604866560, 1059555794188939275, 757537572, 62576309, 1104175997333708800, 187561714, 351784239, 125143408, 1222591501, 222748037, 44849238, 2452853334, 159541269, 173449447, 26985345, 1731805261, 824761019591450625, 26929440, 16973333, 886847235031519232, 883360024021659648, 833150310524809216, 583001068, 15798091, 25067168, 117022298, 2700131429, 302665348, 3391985055, 141141836, 1347250338, 3314652765, 953745799, 2849876151, 564511791, 2938261973, 1344341743664324608, 730678734689316864, 3131529893, 1264159600858857472, 326184301, 2494186513, 914281548, 18063173, 419757788, 3092919645, 517738272, 1172862188001878016, 38349184, 23169735, 400181671, 16664681, 812361923304034304, 46477493, 1113770602777673729, 1111014811343695872, 916305113630814213, 135998621, 302938456, 1010384732759252997, 4842372993, 801412118, 1351904422046167040, 69732035, 1110536190548168704, 60606206, 2741488593, 14569869, 140955302, 51252892, 992149270399725568, 20070307, 19884529, 3007452653, 260632904, 23424533, 20362684, 2755983617, 2365875094, 3111266633, 130133607], 2=[21575948, 18020612, 49600056, 67584573, 742543573, 19058678, 1146329871418843136, 53963427, 1031950356169809920, 3602010316, 801997428, 883369310265249792, 2425571623, 1214974944066637825, 15157283, 561014615, 868112495713685504, 2170986966, 932242398855475200, 81364561, 936231122895294465, 1647291168, 769634997682655236, 16949344, 1207634475254865921, 80024060, 22812734, 704282873231237121, 381433782, 32372694, 25264158, 144658847, 540113442, 1439661253, 2842903409, 1071430976537018368, 1058805479168712705, 1248268321251876866, 146513211, 2412739760, 145671928, 368240745, 1480749782, 19227096, 843792645906464770, 16683666, 119356526, 849590740246290433, 382937180, 146569971, 352946007, 26719898, 38460961, 1121799138239111168, 23456307, 2838333676, 28076811, 765344292390961152, 1173511684142579713, 46148540, 1459872168, 29744178, 29056724, 1213104217675616256, 4906451067, 297395484, 610659001, 1106193729235402753, 3029701349, 24873392, 1214108358292041728, 1290722208910839809, 329607261, 46756531, 748453510048518145, 3383159573, 2476130260, 149522272, 20699709, 18331985, 453473029, 2212479606, 15748239, 498986721, 20543416, 852538501832769540, 488896002, 2379915792, 36667656, 857193486, 52002602, 733368807612395520, 533578801, 2785680441, 207739658, 793377481982181376, 2666016692, 1321001688279486464, 41702018, 1020242843879788544, 2770753891, 2383882980, 702798054357909504, 194192721, 434525445, 34655603, 1239187692, 453124512, 233180256, 101447362, 1281665097035898880, 223742975, 40354568, 4764882552, 16017475, 16003760, 17393219, 2932558313, 14704278, 216122857, 217015808, 278267245, 152650610, 450896622, 1310156987863310336, 1962214610, 317223956, 96386869, 1235849797191401472, 823255657902129153, 1097501475239092224, 85400142, 734703626099232768, 851985789072408576, 2424097747, 3218868310, 863849562695487489, 18949349, 465870580, 96092282, 1217786733540118528, 28084774, 97219875, 1582533673, 754716839448633344, 743893144618565632, 534981494, 363109588, 77821953, 1463193979, 108882900, 221370027, 1321997786817114112, 1169110058, 2834230515, 1289171523744530438, 2582596082, 1070620981595639808, 1425679045, 91185505, 2194905277, 596696494, 970810775064449024, 23949317, 371726146], 3=[728039605], 4=[19825835], 5=[551426814, 393343766, 80872081, 1058288282503647232], 6=[16343974], 7=[41822696], 8=[3131144855], 9=[10215212], 10=[394581961, 300186148, 211864158, 920692088], 11=[158021529], 12=[2231199386], 13=[14281853], 14=[41676231], 15=[459390022, 18934707], 16=[62123765, 924993637355806720], 17=[136004952], 18=[612473, 15687507], 19=[405769757], 20=[41874178, 1350891294927810560, 200161501, 273994373], 21=[400953126, 14085070, 81875055, 123933889], 22=[465973], 23=[3380282686], 24=[1113747629282930688], 25=[331868929], 26=[189868631], 27=[14499829], 28=[298734224], 29=[568143078], 30=[1652541, 12794362], 31=[394087611, 1255393579507351554, 773543378432786432], 32=[1244892413262311425], 33=[171876607], 34=[115494227], 35=[14291684], 36=[1174254240337977345], 37=[19017675], 38=[14224719], 39=[7587032], 40=[98651557], 41=[755135678422327296], 42=[20973388, 151655222], 43=[3929075062], 44=[56488059], 45=[157981564], 46=[19088758], 47=[22146373], 48=[19477583], 49=[300205226], 50=[20675681], 51=[621533], 52=[14173315], 53=[405605548], 54=[50689731], 55=[84035041], 56=[742143], 57=[3364000629]}
         */
    }

}
